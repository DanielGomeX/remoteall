<!DOCTYPE html>
<html>
<head>
    <title>RC - client and rc - RemoteAll example</title>
</head>
<body>
<script src="http://code.jquery.com/jquery-1.6.1.min.js"></script>
<script src="../../../js/remoteall.js"></script>

<!--CHECK socket.io.js SERVER-->
<script src="http://localhost:8888/socket.io/socket.io.js"></script>

<script>

    /**
     * get hash in array
     */
    function getHashParams() {

        var hashParams = {};
        var e,
                a = /\+/g,  // Regex for replacing addition symbol with a space
                r = /([^&;=]+)=?([^&;]*)/g,
                d = function (s) {
                    return decodeURIComponent(s.replace(a, " "));
                },
                q = window.location.hash.substring(1);

        while (e = r.exec(q))
            hashParams[d(e[1])] = d(e[2]);

        return hashParams;
    }


    var params = getHashParams();


    if (params.type == 'post') {
        //POST RC----------------------------------------------
        var data = null;
        var req_url = params.host + '/emit'

        $(document).ready(function () {

            var send_data = function (data) {
                jQuery.post(
                        req_url,
                        {
                            app:params.app,
                            session_id:params.session_id,
                            emit_data:JSON.stringify(data)
                        }
                )
            }

            $('.sel-key')
                    .mousedown(function () { // send json data to server
                        data = {event_name:'button_down', button_code:$(this).data('button-code')};
                        send_data(data);
                    })
                    .mouseup(function () {
                        data = {event_name:'button_up', button_code:$(this).data('button-code')};
                        send_data(data);
                    })
        })
    } else {
        //JS RC----------------------------------------------
        var REMOTE_ALL_CONFIG = {
            url: params.host,
            appId: params.app,
            uniqueSessionId: params.session_id

        }
        var ra = new remoteAll(REMOTE_ALL_CONFIG, function (context, args) {
            // do nothing
        });
        $(document).ready(function () {
            $('.sel-key')
                    .mousedown(function () {
                        ra.sendCode({event_name:'button_down', button_code:$(this).data('button-code')});
                    })
                    .mouseup(function () {
                        ra.sendCode({event_name:'button_up', button_code:$(this).data('button-code')});
                    })
        })
    }


</script>
<link rel="stylesheet" type="text/css" href="css/rc.css"/>
<div id="rc">
    <a id="rc_key_RIGHT" class="sel-key" data-button-code="RIGHT">
        <div class="selk-image selk-image_RIGHT"></div>
    </a>
    <a id="rc_key_LEFT" class="sel-key" data-button-code="LEFT">
        <div class="selk-image selk-image_LEFT"></div>
    </a>
    <a id="rc_key_DOWN" class="sel-key" data-button-code="DOWN">
        <div class="selk-image selk-image_DOWN"></div>
    </a>

    <a id="rc_key_UP" class="sel-key" data-button-code="UP">
        <div class="selk-image selk-image_UP"></div>
    </a>
    <a id="rc_key_ENTER" class="sel-key">
        <div class="selk-image selk-image_ENTER"></div>
    </a>
    <a id="rc_key_TOOLS" class="sel-key">
        <div class="selk-image selk-image_TOOLS"></div>
    </a>

    <a id="rc_key_RED" class="sel-key">
        <div class="selk-image selk-image_RED"></div>
    </a>
    <a id="rc_key_GREEN" class="sel-key">
        <div class="selk-image selk-image_GREEN"></div>
    </a>
    <a id="rc_key_YELLOW" class="sel-key">
        <div class="selk-image selk-image_YELLOW"></div>
    </a>
    <a id="rc_key_BLUE" class="sel-key">
        <div class="selk-image selk-image_BLUE"></div>
    </a>

</div>
</body>
</html>